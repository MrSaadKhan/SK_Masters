# Project

**Quick overview**

This repository contains code to preprocess KDDI (or similar) network flow data, generate embeddings, run classification, and produce plots. The typical workflow is:

1. Download the dataset (place it under `data/` or point the scripts at the correct path).
2. Run the data preprocessing script to convert raw data into the expected input format.
3. Run `x.py` to create embeddings and perform classification.
4. Run `plot.py` to generate the visualizations from `x.py` outputs.

---

## Prerequisites

* **Python**: 3.8+ recommended (adjust for project compatibility).
* **RAM / Disk**: enough to hold the dataset and embeddings (depends on dataset size).
* **GPU (optional)**: if you want to use GPU acceleration, install the appropriate **CUDA runtime** for your GPU and the matching PyTorch build.

  * On Windows, also install **MSVC / Visual Studio Build Tools** via the Visual Studio Installer (required for some compiled packages).
* `git` to clone the repo.

## Clone the repository

```bash
git clone <YOUR_REPO_URL>
cd <REPO_DIRECTORY>
```

Replace `<YOUR_REPO_URL>` with your repository URL.

---

## Create a Python environment (recommended)

Using `venv` (standard):

```bash
python -m venv venv
# Windows
venv\Scripts\activate
# macOS / Linux
source venv/bin/activate
```

Or with `conda`:

```bash
conda create -n myenv python=3.10
conda activate myenv
```

---

## Install Python packages

Make sure you have `requirements.txt` in the repo root. Then run:

```bash
pip install --upgrade pip
pip install -r requirements.txt
```

### Troubleshooting PyTorch install

If `pip install -r requirements.txt` fails while trying to install `torch` / `torchvision` / `torchaudio`:

1. Check the official PyTorch selector at `https://pytorch.org/get-started/locally/` and copy the `pip` command that matches your OS, Python version, and CUDA version.
2. If you want CPU-only PyTorch, you can install the CPU wheels explicitly (e.g. `pip install torch --index-url https://download.pytorch.org/whl/cpu`).
3. If the latest version does not work for your environment, try installing a slightly older matching wheel for your Python/CUDA versions.

> On Windows, ensure MSVC (Visual Studio Build Tools) and cuda runtime (gpu) is installed before installing python packages.

---

## Download the data

Put your dataset in a folder named `data/` at the repository root, or change the paths in the scripts to point to your data location.

If you have a script to download the dataset, run:

```bash
bash scripts/download_data.sh
# or
python scripts/download_data.py --out data/
```

Replace these commands with your project's actual downloader if present.

---

## Data preprocessing

Run the preprocessing script to convert raw data into the format expected by `x.py`.

Example:

```bash
python data_preprocessing.py --input data/raw --output data/processed
```

Expected outputs of preprocessing (adjust names if your scripts differ):

* `data/processed/merged_embeddings.txt` (or similar merged .txt files that contain timestamps and vectors)
* any metadata files required by `x.py`

---

## Run embeddings & classification (`x.py`)

`x.py` handles the embedding generation and classification pipeline.

Example usage (replace flags with your script's actual options):

```bash
# CPU
python x.py --data data/processed --device cpu --out results/

# GPU (if available)
python x.py --data data/processed --device cuda --out results/ --batch-size 64
```

Notes:

* If your script expects merged `.txt` files with timestamps followed by vector entries (see project notes), ensure preprocessing produces that format.
* If there are additional required arguments (model name, checkpoint path, train/test split settings), pass them on the command line or edit `x.py` defaults.

---

## Plotting (`plot.py`)

After `x.py` finishes and writes results to `results/` (or your chosen output directory), run:

```bash
python plot.py --input results/ --out plots/
```

This will generate the "nice plots" referenced in the project notes (confusion matrices, embedding visualizations, performance curves, etc.).

---

## Outputs and artifacts

Typical files you will find in the results directory:

* `results/model_checkpoint.pt` — saved model weights (if saving enabled)
* `results/metrics.json` — numeric metrics for runs
* `results/confusion_matrix.png` — saved confusion matrix plot
* `plots/` — additional visualization output generated by `plot.py`

Adjust based on how your scripts name their outputs.

---

## Common issues & fixes

* **Torch install fails**: Check CUDA compatibility and MSVC installation on Windows. Try a CPU-only torch wheel if GPU wheels aren’t compatible.
* **Out-of-memory with GPU**: reduce `--batch-size` or switch to `--device cpu`.
* **Missing data files**: verify the `--data` path passed to `x.py` and that preprocessing wrote the expected files.

---

## Development tips

* Keep `requirements.txt` synced with your development environment by running `pip freeze > requirements.txt` (only include packages you actually need).
* Add example config files (e.g. `config.example.json`) so users know what keys/paths are required.

---

## Contributing

If you want to improve the repo, please open a pull request. Include:

* A short description of the change
* Any additional installation or runtime steps
* Example commands for testing

---

## License

Add your preferred license here (e.g. MIT, Apache-2.0).

---

## Contact

If you need help running the code, share the terminal output and which OS / Python / CUDA versions you are using.

*End of README*
